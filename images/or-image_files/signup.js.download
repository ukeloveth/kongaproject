(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{PgR5:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/signup",function(){var e=a("s7nH");return{page:e.default||e}}])},s7nH:function(e,t,a){"use strict";a.r(t);var n=a("pbKT"),r=a.n(n),s=a("ln6h"),i=a.n(s),o=a("O40h"),u=a("p0XB"),c=a.n(u),l=a("UXZV"),p=a.n(l),m=a("vYYK"),d=a("pLtp"),h=a.n(d),g=a("zrwo"),f=a("0iUn"),v=a("sLSF"),b=a("Tit0"),w=a("MI3g"),y=a("a7VT"),E=a("q1tI"),P=a.n(E),S=(a("17x9"),a("/MKj")),N=a("fvjX"),C=a("8cHP"),O=a("98oD"),j=a("W6PO"),k=a.n(j),F=a("BG67"),T=a.n(F),x=a("PbmA"),L=a("PYBl"),q=a.n(L),U=a("Qdgr"),A=a("ioyF"),D=a("FuK2"),H=a("B3rz"),I=a("6kA8"),_=a("azIb"),B=a("LqoU"),R=a("lgyL"),M=a.n(R);function G(e){var t=function(){if("undefined"==typeof Reflect||!r.a)return!1;if(r.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(y.default)(e);if(t){var s=Object(y.default)(this).constructor;a=r()(n,arguments,s)}else a=n.apply(this,arguments);return Object(w.default)(this,a)}}var X=O.a.auth,K=X.setSignupData,V=X.setUserDetails,z=O.a.cart.setCartData,W=O.a.flash.showFlashMessage,Y=_.a.flash.variants,J={signup:"signup"},Q=k.a.redis,Z=k.a.userPasswordCacheKeyPrefix,$=k.a.userPasswordCachelifetime,ee=function(e){Object(b.default)(a,e);var t=G(a);function a(e){var n;return Object(f.default)(this,a),(n=t.call(this,e)).state={input:Object(g.a)({},e.input,{password:""}),error:e.errMsg,passwordType:e.passwordType,loading:!1},n.registrationService=new B.a,n.cacheClient=Q.cacheEnabled?T.a.get("cache"):null,n}return Object(v.default)(a,[{key:"onChangeHandler",value:function(e){var t=h()(e)[0];this.setState(function(a){return{input:Object(g.a)({},a.input,Object(m.a)({},t,e[t])),error:Object(g.a)({},a.error,Object(m.a)({},t,""))}})}},{key:"setLoadingState",value:function(e){this.setState({loading:e})}},{key:"_storeUserPasswordInCache",value:function(e,t){this.cacheClient&&this.cacheClient.set("".concat(Z).concat(e),t,"EX",$)}},{key:"submitForm",value:function(e){var t=this;e.preventDefault(),this.setLoadingState(!0);var a=this.props,n=a.setSignupData,r=a.showFlashMessage,s=Object(g.a)({},this.state.input);this.registrationService.registerUser(s).then(function(e){if(t.setLoadingState(!1),k.a.signupWithPhoneToken){var a=window.btoa(s.password);t._storeUserPasswordInCache(s.email,a);var i=Object(x.omit)(s,["password"]),o=p()({},{input:i},{pinId:e});return n(o),C.Router.pushRoute("/account/verify")}r({title:"Signup",content:"Signup successful",variant:Y.SUCCESS}),Object(U.b)(e,t.props,"Signup")?C.Router.pushRoute("/"):C.Router.pushRoute("/account/login")}).catch(function(e){t.handleError(e)})}},{key:"handleError",value:function(e){var t=p()({},e);this.setState({error:t,loading:!1})}},{key:"togglePasswordVisibility",value:function(e){e.preventDefault(),this.setState(function(e){return{passwordType:!e.passwordType}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.input,n=t.error,r=t.loading,s=this.state.passwordType||this.props.passwordType;return P.a.createElement(E.Fragment,null,P.a.createElement(H.a,{title:"Signup"}),P.a.createElement(D.a,{alternative:{text:"Already have an Account?",url:"/account/login",button:"Login"},header:"Create An Account",title:"Signup"},P.a.createElement("form",{action:"/account/signup",className:M.a.signupForm,method:"POST",onSubmit:function(t){return e.submitForm(t)}},P.a.createElement("input",{name:"type",type:"hidden",value:"signup"}),P.a.createElement("div",{className:M.a.inputGroup},P.a.createElement("label",{htmlFor:"firstname"},"First Name"),P.a.createElement("input",{className:n.firstname?M.a.inputError:"",id:"firstname",name:"firstname",onChange:function(t){return e.onChangeHandler({firstname:t.target.value.trim()})},placeholder:"Enter First Name",required:!0,type:"text",value:a.firstname}),P.a.createElement("div",{className:M.a.error}," ",c()(n.firstname)&&n.firstname[0]," ")),P.a.createElement("div",{className:M.a.inputGroup},P.a.createElement("label",{htmlFor:"lastname"},"Last Name"),P.a.createElement("input",{className:n.lastname?M.a.inputError:void 0,id:"lastname",name:"lastname",onChange:function(t){return e.onChangeHandler({lastname:t.target.value.trim()})},placeholder:"Enter Last Name",required:!0,type:"text",value:a.lastname}),P.a.createElement("div",{className:M.a.error}," ",c()(n.lastname)&&n.lastname[0]," ")),P.a.createElement("div",{className:M.a.inputGroup},P.a.createElement("label",{htmlFor:"email"},"Email Address"),P.a.createElement("input",{className:n.email?M.a.inputError:"",id:"email",name:"email",onChange:function(t){return e.onChangeHandler({email:t.target.value.trim()})},placeholder:"Enter Email Address",required:!0,type:"email",value:a.email}),P.a.createElement("div",{className:M.a.error}," ",c()(n.email)&&n.email[0])),P.a.createElement("div",{className:M.a.inputGroup},P.a.createElement("label",{htmlFor:"phone"},"Phone Number"),P.a.createElement("input",{className:n.phone?M.a.inputError:"",id:"phone",maxLength:11,name:"phone",onChange:function(t){return e.onChangeHandler({phone:t.target.value.trim()})},placeholder:"Enter Phone Number",required:!0,type:"tel",value:a.phone}),P.a.createElement("div",{className:M.a.error}," ",c()(n.phone)&&n.phone[0]," ")),P.a.createElement("div",{className:M.a.inputGroup},P.a.createElement("label",{htmlFor:"password"},"Password"),P.a.createElement("input",{className:n.password?M.a.inputError:"",id:"password",name:"password",onChange:function(t){return e.onChangeHandler({password:t.target.value.trim()})},placeholder:"Enter Password",required:!0,type:s?"text":"password",value:a.password}),P.a.createElement("a",{className:M.a.showPassword,href:"/account/signup?showPassword=".concat(!s),onClick:function(t){return e.togglePasswordVisibility(t)},tabIndex:"-1",type:"button"},s?"Hide":"Show"),P.a.createElement("div",{className:M.a.error}," ",c()(n.password)&&n.password[0]," ")),P.a.createElement(I.a,{className:M.a.signupButton,loading:r,type:"submit",variants:_.a.buttonVariants.success},"Create an Account"),P.a.createElement("div",{className:M.a.signupBottom},P.a.createElement("span",null,"By signing up you accept our "),P.a.createElement(C.Link,{route:"/content/terms-and-conditions"},P.a.createElement("a",{href:"/content/terms-and-conditions",target:"_blank"},"terms and conditions")),P.a.createElement("div",{className:M.a.privacyPolicy},P.a.createElement(C.Link,{route:"/content/privacy-policy"},P.a.createElement("a",{href:"/content/privacy-policy",target:"_blank"},"& privacy policy")))))))}}],[{key:"getInitialProps",value:function(){var e=Object(o.default)(i.a.mark(function e(t){var a,n,r,s,o,u,c,l,m,d,h,g;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.store,n=t.req,r=t.res,!Object(x.isPost)(n)){e.next=30;break}if(!(o=n.body)){e.next=30;break}u=J[o.type],c=p()({},{input:Object(x.omit)(o,["type","password"])}),a.dispatch(K(c)),l=new B.a,e.t0=u,e.next="signup"===e.t0?11:29;break;case 11:return e.prev=11,m=Object(x.omit)(o,["type"]),e.next=15,l.registerUser(m);case 15:if(d=e.sent,!k.a.signupWithPhoneToken){e.next=20;break}return h=p()({},{input:o},{pinId:d}),Object(U.e)(n,a,h),e.abrupt("return",Object(A.q)("/account/verify",r));case 20:return Object(A.u)(n,{title:"Signup",content:"Signup successful, please login now",variant:Y.SUCCESS}),e.abrupt("return",Object(A.q)("/account/login",r));case 24:e.prev=24,e.t1=e.catch(11),q.a.error("[Signup.getInitialProps] Error registering user",e.t1),s=e.t1;case 28:case 29:return e.abrupt("break",30);case 30:return g=n&&n.query&&"true"===n.query.showPassword,e.abrupt("return",{passwordType:g,errMsg:s,basePage:{hideNavigation:!0}});case 32:case"end":return e.stop()}},e,null,[[11,24]])}));return function(t){return e.apply(this,arguments)}}()}]),a}(E.Component);ee.defaultProps={socialAuthLinks:{},passwordType:!1,errMsg:{},input:{firstname:"",lastname:"",email:"",phone:"",password:""}};var te=Object(S.b)(function(e){var t=e.auth,a=t.account.guest,n=t.signup.input;return{cart:e.cart.data,input:n,guest:a}},function(e){return Object(N.b)({setCartData:z,setSignupData:K,setUserDetails:V,showFlashMessage:W},e)})(ee);a.d(t,"default",function(){return te})}},[["PgR5",1,2,0,3]]]);